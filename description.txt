
Here's the reorganized schema sorted by categories with their datatypes and RLS policies:

---

### 🔐 **Authentication & User Management**
#### **users**
- `id` – `uuid`
- `name` – `text`
- `email` – `text`
- `password` – `text`
- `created_at` – `timestamp`
- `updated_at` – `timestamp`
- `username` – `text`

**RLS Policies:**
- DELETE: Users can delete their own record (authenticated role)
- INSERT: Users can insert their own record (authenticated role)
- SELECT: Users can select their own record (authenticated role)
- UPDATE: Users can update their own record (authenticated role)

#### **user_settings**
- `id` – `uuid`
- `user_id` – `uuid`
- `setting_key` – `text`
- `setting_value` – `text`

**RLS Policies:**
- DELETE: Users can delete their own settings (authenticated role)
- INSERT: Users can insert their own settings (authenticated role)
- SELECT: Users can select their own settings (authenticated role)
- UPDATE: Users can update their own settings (authenticated role)

---

### 💬 **Chat System**
#### **chat_sessions**
- `id` – `uuid`
- `user_id` – `uuid`
- `title` – `text`
- `started_at` – `timestamp`
- `updated_at` – `timestamp`

**RLS Policies:**
- DELETE: Users can delete their own chat sessions (authenticated role)
- INSERT: Users can insert their own chat sessions (authenticated role)
- SELECT: Users can select their own chat sessions (authenticated role)
- UPDATE: Users can update their own chat sessions (authenticated role)

#### **chat_messages**
- `id` – `uuid`
- `session_id` – `uuid`
- `is_ai` – `bool`
- `message` – `text`
- `timestamp` – `timestamp`
- `updated_at` – `timestamp`

**RLS Policies:**
- DELETE: Users can delete their own chat messages (authenticated role)
- INSERT: Users can insert their own chat messages (authenticated role)
- SELECT: Users can select their own chat messages (authenticated role)
- UPDATE: Users can update their own chat messages (authenticated role)

#### **chat_history**
- `id` – `uuid`
- `user_id` – `uuid`
- `message` – `text`
- `timestamp` – `timestamp`
- `is_ai` – `bool`

**RLS Policies:**
- ALL: Users can only access own chat history (public role)

---

### 📅 **Calendar & Scheduling**
#### **calendar_events**
- `id` – `uuid`
- `user_id` – `uuid`
- `title` – `text`
- `event_date` – `date`
- `event_time` – `time`
- `type` – `text`
- `description` – `text`
- `created_at` – `timestamp`
- `updated_at` – `timestamp`

**RLS Policies:**
- DELETE: Users can delete their own events (authenticated role)
- INSERT: Users can insert their own events (authenticated role)
- SELECT: Users can select their own events (authenticated role)
- UPDATE: Users can update their own events (authenticated role)

#### **tasks**
- `id` – `uuid`
- `user_id` – `uuid`
- `title` – `text`
- `task_date` – `date`
- `task_time` – `time`
- `completed` – `bool`
- `created_at` – `timestamp`
- `updated_at` – `timestamp`
- `task_type` – `text`
- `due_date` – `date`
- `last_reset_date` – `date`
- `urgency_level` – `int`
- `status` – `text`

**RLS Policies:**
- ALL: tasks_user_policy (authenticated role)
- DELETE: Users can delete their own tasks (authenticated role)
- INSERT: Users can insert their own tasks (authenticated role)
- SELECT: Users can select their own tasks (authenticated role)
- UPDATE: Users can update their own tasks (authenticated role)

---

### 📔 **Personal Journaling**
#### **diary_entries**
- `id` – `uuid`
- `user_id` – `uuid`
- `entry_date` – `date`
- `title` – `text`
- `content` – `text`
- `mood` – `mood_scale`
- `created_at` – `timestamp`
- `updated_at` – `timestamp`

**RLS Policies:**
- DELETE: Users can delete their own diary entries (authenticated role)
- INSERT: Users can insert their own diary entries (authenticated role)
- SELECT: Users can select their own diary entries (authenticated role)
- UPDATE: Users can update their own diary entries (authenticated role)

--- 



-------------------------------------------------

Existing RLS Policies Descriptions
Users can only access own chat history

Action: ALL
Definition: This policy allows authenticated users to access all records in the chat_history table where the user_id matches the user's ID. This ensures that users can only see their own chat history.
Users can delete their own record

Action: DELETE
Definition: This policy permits authenticated users to delete their own records in the chat_history table, specifically where the id of the record matches the user's ID.
Users can insert their own record

Action: INSERT
Check: This policy allows authenticated users to insert new records into the chat_history table, with a check that ensures the id of the new record matches the user's ID.
Users can select their own record

Action: SELECT
Definition: This policy allows authenticated users to select (read) their own records in the chat_history table, ensuring that they can only access records where the id matches their own.
Users can update their own record

Action: UPDATE
Definition: This policy allows authenticated users to update their own records in the chat_history table, ensuring that they can only modify records where the id matches their own.
Users can delete their own settings

Action: DELETE
Definition: This policy allows authenticated users to delete their own settings in the user_settings table, specifically where the user_id matches the user's ID.
Users can insert their own settings

Action: INSERT
Check: This policy allows authenticated users to insert new settings into the user_settings table, with a check that ensures the user_id of the new setting matches the user's ID.
Users can select their own settings

Action: SELECT
Definition: This policy allows authenticated users to select (read) their own settings in the user_settings table, ensuring that they can only access records where the user_id matches their own.
Users can update their own settings

Action: UPDATE
Definition: This policy allows authenticated users to update their own settings in the user_settings table, ensuring that they can only modify records where the user_id matches their own.
Users can delete their own events

Action: DELETE
Definition: This policy allows authenticated users to delete their own events in the calendar_events table, specifically where the user_id matches the user's ID.
Users can insert their own events

Action: INSERT
Check: This policy allows authenticated users to insert new events into the calendar_events table, with a check that ensures the user_id of the new event matches the user's ID.
Users can select their own events

Action: SELECT
Definition: This policy allows authenticated users to select (read) their own events in the calendar_events table, ensuring that they can only access records where the user_id matches their own.
Users can update their own events

Action: UPDATE
Definition: This policy allows authenticated users to update their own events in the calendar_events table, ensuring that they can only modify records where the user_id matches their own.
Users can delete their own tasks

Action: DELETE
Definition: This policy allows authenticated users to delete their own tasks in the tasks table, specifically where the user_id matches the user's ID.
Users can insert their own tasks

Action: INSERT
Check: This policy allows authenticated users to insert new tasks into the tasks table, with a check that ensures the user_id of the new task matches the user's ID.
Users can select their own tasks

Action: SELECT
Definition: This policy allows authenticated users to select (read) their own tasks in the tasks table, ensuring that they can only access records where the user_id matches their own.
Users can update their own tasks

Action: UPDATE
Definition: This policy allows authenticated users to update their own tasks in the tasks table, ensuring that they can only modify records where the user_id matches their own.
Users can delete their own chat sessions

Action: DELETE
Definition: This policy allows authenticated users to delete their own chat sessions in the chat_sessions table, specifically where the user_id matches the user's ID.
Users can insert their own chat sessions

Action: INSERT
Check: This policy allows authenticated users to insert new chat sessions into the chat_sessions table, with a check that ensures the user_id of the new session matches the user's ID.
Users can select their own chat sessions

Action: SELECT
Definition: This policy allows authenticated users to select (read) their own chat sessions in the chat_sessions table, ensuring that they can only access records where the user_id matches their own.
Users can update their own chat sessions

Action: UPDATE
Definition: This policy allows authenticated users to update their own chat sessions in the chat_sessions table, ensuring that they can only modify records where the user_id matches their own.
Users can delete their own chat messages

Action: DELETE
Definition: This policy allows authenticated users to delete their own chat messages in the chat_messages table, specifically where the session_id corresponds to sessions owned by the user.
**